document.getElementById("rsvpForm").addEventListener("submit", function (event) {
  event.preventDefault();

  const nome = document.getElementById("nome").value;
  const confirmacao = document.getElementById("confirmacao").value;
  const mensagem = document.getElementById("mensagem");

  if (!nome || !confirmacao) {
      mensagem.textContent = "Por favor, preencha todos os campos.";
      mensagem.style.color = "red";
      return;
  }

  // URL do Google Apps Script (substitua pela sua)
  const scriptURL = "https://script.google.com/macros/s/AKfycbwfwrMuPOGR5A1YoouB00BQfjXk8tAQ8jumYO6anKx-0e9imQq1qxrGa_8S9Cal3tc/exec";

  const formData = new URLSearchParams();
  formData.append("nome", nome);
  formData.append("confirmacao", confirmacao);

  fetch(scriptURL, {
      method: "POST",
      body: formData
  })
  .then(response => response.text())
  .then(text => {
      mensagem.textContent = "Confirmação enviada com sucesso!";
      mensagem.style.color = "green";
      document.getElementById("rsvpForm").reset();
  })
  .catch(() => {
      mensagem.textContent = "Erro ao enviar a confirmação.";
      mensagem.style.color = "red";
  });
});
